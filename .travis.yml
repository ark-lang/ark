language: c

before_install:
  - sudo bash -c "echo 'deb http://lgp203.free.fr/ubuntu quantal universe' >> /etc/apt/sources.list.d/lgp203.free.fr.source.list"
  - sudo apt-get update
install: sudo apt-get install --force-yes make premake4

compiler:
- gcc
- clang

script: premake4 embed && premake4 gmake && make

notifications:
  email: false

deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    secure: GN+DA/sFpSo5wEAOI/DWintVrMgPZ6F4t1FlZqHEjxp/qU6rpuYtvcs56TahgSbPWuo2CHw4q/fQkElJDTysqrZG3H8AkdiRu/7bvJNyvJsbPjArKW8pOw531Y6fvjsuxSLoKZoFtmbE93HLJQvoBiaxo6pGOmR+lA39XnSHfgQ=
  file: alloyc-linux
  on:
    tags: true
    all_branches: true
    repo: alloy-lang/alloy
